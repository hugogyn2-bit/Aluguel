enum Role {
  TENANT
  OWNER
}

model User {
  id           String   @id @default(cuid())
  email        String   @unique
  name         String?
  passwordHash String

  role         Role     @default(TENANT)

  // ‚úÖ Trial (24h)
  trialEndsAt     DateTime?
  trialStartedAt  DateTime?

  // ‚úÖ Premium interno do app
  ownerPaid       Boolean   @default(false)
  premiumStartedAt DateTime?

  // ‚úÖ Stripe
  stripeCustomerId       String?  @unique
  stripeSubscriptionId   String?  @unique
  stripePriceId          String?
  stripeStatus           String?  // active, trialing, canceled, past_due...
  currentPeriodEnd       DateTime?
  cancelAtPeriodEnd      Boolean  @default(false)

  // ‚úÖ Seguran√ßa extra (somente OWNER)
  birthDate    DateTime?

  // ‚úÖ TENANT troca senha no primeiro login
  mustChangePassword Boolean @default(false)

  // üîê Reset de senha por token
  resetPasswordToken   String?
  resetPasswordExpires DateTime?

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  tenantProfile TenantProfile? @relation("TenantUser")
  ownedTenants  TenantProfile[] @relation("OwnerTenants")
}
